# Feature Specification: Demo Interface

**Feature Branch**: `001-demo-interface`
**Created**: 2026-02-23
**Status**: Draft
**Input**: User description: "创建演示界面：前端2个页面（前台实时字幕展示+后台控制中心），支持中英双语可切换，后端模拟随机生成字幕，不需要真正的转录功能"

## Clarifications

### Session 2026-02-23

- Q: 前台显示模式支持哪些选项？ → A: 支持三种模式：仅中文、仅英文、中英双语
- Q: 字幕对象包含哪些文本字段？ → A: 包含原始文本、优化文本、翻译文本三项；用户优先收到原始文本，后端异步优化+翻译后更新
- Q: 字幕有哪几种状态？ → A: 两种：已确认字幕（完整三字段）、正在转录字幕（只有原始和翻译，无优化文本）
- Q: 优化和翻译的延迟时间？ → A: 可配置，默认2秒，实际延迟为配置值±1秒随机值

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 听众观看实时字幕 (Priority: P1)

作为一名听众，我希望打开网页就能看到实时滚动的字幕，这样我可以跟上演讲内容。

**Why this priority**: 这是产品的核心价值——为听众提供实时字幕服务。没有这个功能，其他功能都没有意义。

**Independent Test**: 打开前台页面，能看到模拟字幕逐字出现并滚动显示。

**Acceptance Scenarios**:

1. **Given** 前台页面已加载，**When** 模拟字幕正在生成，**Then** 字幕实时显示在页面上并自动滚动
2. **Given** 前台页面已加载，**When** 用户进入页面时模拟已在运行，**Then** 显示当前字幕状态和历史字幕
3. **Given** 字幕正在显示，**When** 新字幕段落确认，**Then** 当前字幕移入历史区域，新字幕成为当前字幕

---

### User Story 2 - 操作员控制模拟字幕 (Priority: P1)

作为一名操作员，我希望在后台页面启动/停止模拟字幕，这样我可以控制演示流程。

**Why this priority**: 与前台展示同等重要，没有控制功能无法演示产品。

**Independent Test**: 在后台页面点击开始按钮，前台能收到字幕；点击停止，字幕停止生成。

**Acceptance Scenarios**:

1. **Given** 后台页面已加载，**When** 操作员点击"开始模拟"，**Then** 系统开始随机生成中英文字幕
2. **Given** 模拟正在运行，**When** 操作员点击"停止模拟"，**Then** 字幕生成立即停止
3. **Given** 模拟正在运行，**When** 操作员点击"清空字幕"，**Then** 所有前台页面的字幕立即清空

---

### User Story 3 - 听众切换语言显示模式 (Priority: P2)

作为一名听众，我希望可以切换显示模式（仅中文/仅英文/双语），这样我可以根据需要选择显示内容。

**Why this priority**: 增强用户体验，但不是核心功能，可以在基础版本后添加。

**Independent Test**: 在前台页面切换显示模式，字幕显示相应变化。

**Acceptance Scenarios**:

1. **Given** 前台页面显示双语，**When** 用户切换为"仅中文"，**Then** 只显示中文字幕
2. **Given** 前台页面显示双语，**When** 用户切换为"仅英文"，**Then** 只显示英文字幕
3. **Given** 前台页面只显示中文，**When** 用户切换为"双语"，**Then** 同时显示中文和英文字幕
4. **Given** 用户切换了显示模式，**When** 刷新页面，**Then** 保持用户的选择偏好

---

### User Story 4 - 操作员查看系统状态 (Priority: P2)

作为一名操作员，我希望看到当前有多少客户端连接、模拟是否在运行等信息，这样我可以监控系统状态。

**Why this priority**: 便于操作员了解系统状态，但对核心功能影响较小。

**Independent Test**: 后台页面显示连接数和运行状态。

**Acceptance Scenarios**:

1. **Given** 后台页面已加载，**When** 有客户端连接，**Then** 显示当前连接数
2. **Given** 后台页面已加载，**When** 模拟正在运行，**Then** 显示"运行中"状态
3. **Given** 模拟已停止，**When** 后台页面刷新，**Then** 显示"已停止"状态

---

### Edge Cases

- 当网络断开时，前台显示断开连接提示，重连后自动恢复字幕同步
- 当没有客户端连接时，后台仍可启动模拟，字幕在客户端连接后推送
- 当用户同时打开多个前台页面时，所有页面应同步显示相同字幕
- 当模拟生成速度过快时，字幕不应堆积，应平滑显示

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系统必须提供前台页面，显示实时滚动的字幕内容
- **FR-002**: 系统必须提供后台页面，包含开始/停止模拟和清空字幕的控制按钮
- **FR-003**: 系统必须支持前台用户切换语言显示模式（仅中文/仅英文/双语）
- **FR-004**: 系统必须通过实时通信向前台推送字幕更新
- **FR-005**: 系统必须随机生成中英文对照的模拟字幕内容
- **FR-006**: 系统必须在后台显示当前连接的客户端数量
- **FR-007**: 系统必须在后台显示模拟器的运行状态（运行中/已停止）
- **FR-008**: 系统必须在清空字幕时通知所有已连接的前台客户端，立即清空前台显示
- **FR-009**: 系统必须在前台显示连接状态指示器（已连接/断开连接）
- **FR-010**: 系统必须保存用户的语言显示偏好
- **FR-011**: 系统必须区分两种字幕状态：正在转录（进行中）和已确认
- **FR-012**: 系统必须优先推送字幕原始文本，异步完成优化和翻译后更新
- **FR-013**: 正在转录的字幕只包含原始文本和翻译文本，不包含优化文本
- **FR-014**: 后台必须支持配置优化翻译的延迟时间（默认2秒），实际延迟为配置值±1秒随机值

### Key Entities

- **已确认字幕 (Confirmed Subtitle)**: 已完成转录的字幕段落，包含：
  - 唯一标识符 (id)
  - 原始文本 (rawText): 转录的原始输出
  - 优化文本 (optimizedText): 经过纠错和优化的文本（异步更新）
  - 翻译文本 (translatedText): 英文翻译（与优化文本同步更新）
  - 时间戳 (timestamp)
- **正在转录字幕 (Active Subtitle)**: 正在进行中的字幕，只有原始文本和翻译文本，无优化文本
- **模拟状态 (Simulation State)**: 系统模拟器的当前状态，包括运行状态（运行中/已停止）和当前生成的字幕内容
- **客户端连接 (Client Connection)**: 与系统的实时连接，用于推送字幕更新
- **用户偏好 (User Preference)**: 用户的前台显示设置，包括语言模式（仅中文/仅英文/双语）

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 原始字幕从生成到显示的延迟不超过 500 毫秒
- **SC-002**: 优化和翻译后的字幕在配置的延迟时间内（默认2秒±1秒）更新到前端
- **SC-003**: 系统支持至少 10 个并发客户端连接同时接收字幕
- **SC-004**: 用户切换语言显示模式后，界面在 100 毫秒内响应变化
- **SC-005**: 操作员可以在 3 次点击内完成"开始模拟"或"停止模拟"操作
- **SC-006**: 用户刷新页面后，字幕显示在 1 秒内恢复同步
- **SC-007**: 100% 的操作员能在首次使用时理解如何控制模拟字幕

## Assumptions

- 模拟字幕使用预设的中英文对照句子库，随机选择并逐字输出
- 模拟器会模拟"原始→优化+翻译"的两阶段更新过程
- 用户偏好保存在浏览器本地存储中
- 不需要用户认证系统
- 不需要持久化字幕历史记录
- 单个演示实例，无需多租户支持
